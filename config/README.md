# Конфигурация калькулятора

Этот файл содержит все настройки цен и параметров калькулятора, которые синхронизированы между backend и frontend.

## Структура файла

### 1. Ценообразование (`pricing`)

```json
{
  "pricing": {
    "base_cost_per_km": 10.0,           // Стоимость за 1 км (руб)
    "duration_cost_per_hour": 100.0,    // Стоимость за 1 час (руб)
    "urgent_pickup_multiplier": 1.3,    // Множитель для срочной подачи
    "loader_price_per_hour": 500.0      // Стоимость грузчика за час (руб)
  }
}
```

### 2. Транспортные средства (`vehicles`)

Массив объектов с информацией о каждом транспортном средстве:

```json
{
  "id": 1,                              // Уникальный ID
  "name": "Газель Тент",                // Название
  "type": "gazel",                      // Тип транспорта
  "body_type": "tent",                  // Тип кузова
  "price_per_hour": 800,                // Цена за час (руб)
  "price_per_km": 25,                   // Цена за км (руб)
  "base_price": 500,                    // Базовая цена (руб)
  "max_passengers": 2,                  // Максимум пассажиров
  "max_loaders": 1,                     // Максимум грузчиков
  "dimensions": {                        // Размеры (м)
    "height": 2.0,
    "length": 3.0,
    "width": 2.0
  },
  "capacity": 12.0,                     // Вместимость (м³)
  "image_url": "/static/img/gazel-tent.jpg", // Путь к изображению
  "description": "Описание транспорта"   // Описание
}
```

**Доступные типы транспорта:**
- `gazel` - Газель
- `truck` - Грузовик
- `minibus` - Микроавтобус
- `special` - Спецтранспорт

**Доступные типы кузова:**
- `tent` - Тент
- `van` - Фургон
- `board` - Борт

### 3. Лимиты калькулятора (`calculator_limits`)

```json
{
  "calculator_limits": {
    "max_passengers": 20,               // Максимум пассажиров
    "max_loaders": 10,                  // Максимум грузчиков
    "max_duration_hours": 24,           // Максимум часов
    "min_duration_hours": 1             // Минимум часов
  }
}
```

### 4. Дополнительные услуги (`additional_services`)

```json
{
  "additional_services": {
    "packaging": {
      "name": "Упаковка",
      "price": 500.0,
      "description": "Профессиональная упаковка груза"
    }
  }
}
```

## Как изменить цены

1. Откройте файл `config/calculator_config.json`
2. Измените нужные значения в секции `pricing`
3. Сохраните файл
4. Перезагрузите конфигурацию через API: `POST /api/v2/config/reload`

## Как добавить новый транспорт

1. Добавьте новый объект в массив `vehicles`
2. Укажите уникальный `id`
3. Добавьте изображение в папку `app/static/img/`
4. Укажите правильный путь в `image_url`
5. Перезагрузите конфигурацию

## Как изменить лимиты

1. Измените значения в секции `calculator_limits`
2. Перезагрузите конфигурацию
3. Frontend автоматически обновится с новыми лимитами

## Синхронизация

- **Backend**: Автоматически загружает конфигурацию при запуске
- **Frontend**: Загружает конфигурацию при инициализации и обновляет каждые 5 минут
- **API**: Предоставляет endpoint `/api/v2/config/calculator` для получения актуальной конфигурации

## Валидация

Конфигурация автоматически валидируется при загрузке. Проверяется:
- Наличие всех обязательных секций
- Корректность типов данных
- Наличие всех обязательных полей у транспорта

## Безопасность

- Файл конфигурации не должен содержать секретные данные
- Endpoint перезагрузки конфигурации должен быть защищен авторизацией в продакшене
- Все цены валидируются на backend перед использованием

## Примеры использования

### Изменение базовой стоимости за км
```json
{
  "pricing": {
    "base_cost_per_km": 12.0  // Было 10.0, стало 12.0
  }
}
```

### Добавление нового транспорта
```json
{
  "vehicles": [
    // ... существующий транспорт ...
    {
      "id": 6,
      "name": "Газель Рефрижератор",
      "type": "gazel",
      "body_type": "van",
      "price_per_hour": 1100,
      "price_per_km": 32,
      "base_price": 700,
      "max_passengers": 2,
      "max_loaders": 1,
      "dimensions": {
        "height": 2.0,
        "length": 3.0,
        "width": 2.0
      },
      "capacity": 12.0,
      "image_url": "/static/img/gazel-refrigerator.jpg",
      "description": "Для перевозки скоропортящихся грузов"
    }
  ]
}
```

### Изменение лимитов
```json
{
  "calculator_limits": {
    "max_passengers": 25,  // Было 20, стало 25
    "max_loaders": 15      // Было 10, стало 15
  }
}
```
